<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Conditional GAN</title>

    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/theme.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->    



    <!-- MathJax -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: {autoNumber: "AMS"} } 
    });
    </script>    
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
</head>
<body>
<div class="container">
    \(
    \newcommand{\ve}[1]{\mathbf{#1}}
    \newcommand{\diag}{\mathrm{diag}}
    \newcommand{\Real}{\mathbb{R}}
    \newcommand{\tr}{\mathbb{tr}}
    \DeclareMathOperator*{\argmin}{arg\,min}
    \DeclareMathOperator*{\argmax}{arg\,max}
    \)

    <div class="page-header"><h1>Conditional GAN</h1></div>
    
    <p>
        <a href="https://arxiv.org/pdf/1411.1784.pdf">Conditional Generative Adversarial Network</a> is a short and simple paper by Mirza and Osindero that explores a very important concept: GANs can be made to take extra input to restrict the samples they generate.        
    </p>

    <p>
        In this practice, I'd like to implement the conditional GAN for the MNIST data set in the Mizra-Osindero paper.
    </p>

    <h2>The Architecture</h2>

    <p>
        The paper uses:
    </p>

    <ul>
        <li>$\ve{x}$ to represent the image</li>
        <li>
            $\ve{y}$ to represent the class label.
            <ul>
                <li>One hot vector of dimension 10.</li>
            </ul>
        </li>
        <li>$\ve{z}$ to represent the latent vector.</li>
    </ul>

    <h3>Generator</h3>

    <ul>
        <li>$\ve{z}$ (100) $\rightarrow$ Fully connected (100$\rightarrow$200) $\rightarrow$ ReLu (200): Call this A.</li>
        <li>$\ve{y}$ (10) $\rightarrow$ Fully connected (10$\rightarrow$1000) $\rightarrow$ Relu (1000): Call this B.</li>
        <li>Concat(A,B) (1200) $\rightarrow$ Fully connected (1200->1200) $\rightarrow$ ReLu (1200) $\rightarrow$ Fully connected (1200->768) $\rightarrow$ Sigmoid (768)</li>
    </ul>

    <h3>Discriminator</h3>

    <ul>
        <li>
            $\ve{x}$ (768) 
            $\rightarrow$
            Maxout (768 $\rightarrow$ 240; 5 pieces): Call this A
        </li>
        <li>
            $\ve{y}$ (10)
            $\rightarrow$
            Maxout (10 $\rightarrow$ 50; 5 pieces): Call this B            
        </li>
        <li>
            Concat(A,B) (290)
            $\rightarrow$
            Maxout (290 $\rightarrow$ 240; 4 pieces)
            $\rightarrow$
            Fully connected (240 $\rightarrow$ 1)
            $\rightarrow$
            Sigmoid
        </li>
    </ul>

    <h3>Training</h3>

    <ul>
        <li>Minibatch of size 100.</li>
        <li>Initial learning rate of 0.1, exponetially decay down to $10^{-6}$ with decay factory of $1 + 4 \times 10^{-6}$.</li>
        <li>Momentum used with initial value of $.5$, which was increase to $.7$. (What does this exactly mean?)</li>
        <li>Dropout of probabily of $0.5$ was applied to both generator and discriminator.</li>
        <li>Stoppoing point determine by the best estimate of the log-likelihood on the validation set.</li>
    </ul>

    <h3>Maxout Layer</h3>

    <p>
        We are given input $\ve{x} \in \Real^{1 \times d}$. The maxout unit has two parameters:
        <ul>
            <li>$W \in \Real^{d \times m \times k}$</li>
            <li>$b \in \Real^{1 \times m \times k}$.</li>
        </ul>
        The layer first compute:
        \begin{align*}
            Z = \ve{x} W + b.
        \end{align*}
        Then, it computes $\ve{h} = (h_1, \dotsc, h_m) \in \Real^{1 \times m}$ by setting:
        \begin{align*}
            h_i = \max_{1 \leq j \leq k} \{ z_{ij} \}.
        \end{align*}
    </p>

    <p>
        The number $m$ is the called the "number of units" and $k$ the "number of pieces" by the CGAN paper.
    </p>
</div>

</body>
</html>